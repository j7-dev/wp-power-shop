import{e as Ht,r as p,C as ge,c as fe,Z as Wt,m as Ut,R as Q,$ as Dt,a0 as Qt,a1 as Gt,d as ot,N as i,W as Ne,M as T,a2 as we,P as U,O as Re,a3 as Jt,S as Zt,a4 as Kt,Q as Xt,a5 as Yt,U as it,a6 as Ee,a7 as en,V as tn,Y as nn}from"./main-6a64451b.js";import{f as lt,m as an,Y as Je,Z as rn,w as ct,_ as sn,$ as ut,a0 as Be,O as Le,a1 as Pe,L as on,a2 as ln,a3 as cn,a4 as un,a5 as dn,a6 as fn,q as mn,N as Oe,a7 as hn,a8 as gn,u as pn,o as yn,B as dt,H as vn,I as ie,P as ne,S as bn,T as Cn,M as re,Q as qe,J as ye,a9 as Me,X as xn,aa as wn,ab as Ze,V as Mn,U as Nn}from"./useAjaxNonce-66a214d0.js";import{h as Pn,j as Ke,P as On,e as Sn,k as _n,l as In,m as kn,o as En,p as $n,q as Xe,t as Tn,v as An,w as jn,x as Fn,u as ft,L as Ae,I as mt,d as he,y as ht,n as Rn,s as Bn,S as Ln,A as qn,c as Vn}from"./index-7f75e0c3.js";import{u as gt}from"./useAjax-446ae264.js";const zn=e=>{const{componentCls:t,iconCls:r,boxShadow:a,colorText:s,colorSuccess:l,colorError:f,colorWarning:d,colorInfo:u,fontSizeLG:c,motionEaseInOutCirc:g,motionDurationSlow:m,marginXS:k,paddingXS:E,borderRadiusLG:$,zIndexPopup:b,contentPadding:h,contentBg:O}=e,v=`${t}-notice`,C=new Je("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:E,transform:"translateY(0)",opacity:1}}),A=new Je("MessageMoveOut",{"0%":{maxHeight:e.height,padding:E,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}}),w={padding:E,textAlign:"center",[`${t}-custom-content`]:{display:"flex",alignItems:"center"},[`${t}-custom-content > ${r}`]:{marginInlineEnd:k,fontSize:c},[`${v}-content`]:{display:"inline-block",padding:h,background:O,borderRadius:$,boxShadow:a,pointerEvents:"all"},[`${t}-success > ${r}`]:{color:l},[`${t}-error > ${r}`]:{color:f},[`${t}-warning > ${r}`]:{color:d},[`${t}-info > ${r},
      ${t}-loading > ${r}`]:{color:u}};return[{[t]:Object.assign(Object.assign({},Ht(e)),{color:s,position:"fixed",top:k,width:"100%",pointerEvents:"none",zIndex:b,[`${t}-move-up`]:{animationFillMode:"forwards"},[`
        ${t}-move-up-appear,
        ${t}-move-up-enter
      `]:{animationName:C,animationDuration:m,animationPlayState:"paused",animationTimingFunction:g},[`
        ${t}-move-up-appear${t}-move-up-appear-active,
        ${t}-move-up-enter${t}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${t}-move-up-leave`]:{animationName:A,animationDuration:m,animationPlayState:"paused",animationTimingFunction:g},[`${t}-move-up-leave${t}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[t]:{[`${v}-wrapper`]:Object.assign({},w)}},{[`${t}-notice-pure-panel`]:Object.assign(Object.assign({},w),{padding:0,textAlign:"start"})}]},Hn=e=>({zIndexPopup:e.zIndexPopupBase+rn+10,contentBg:e.colorBgElevated,contentPadding:`${(e.controlHeightLG-e.fontSize*e.lineHeight)/2}px ${e.paddingSM}px`}),pt=lt("Message",e=>{const t=an(e,{height:150});return[zn(t)]},Hn);var Wn=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};const Un={info:p.createElement(ut,null),success:p.createElement(Be,null),error:p.createElement(Le,null),warning:p.createElement(Pe,null),loading:p.createElement(on,null)},yt=e=>{let{prefixCls:t,type:r,icon:a,children:s}=e;return p.createElement("div",{className:fe(`${t}-custom-content`,`${t}-${r}`)},a||Un[r],p.createElement("span",null,s))},Dn=e=>{const{prefixCls:t,className:r,type:a,icon:s,content:l}=e,f=Wn(e,["prefixCls","className","type","icon","content"]),{getPrefixCls:d}=p.useContext(ge),u=t||d("message"),c=ct(u),[g,m,k]=pt(u,c);return g(p.createElement(sn,Object.assign({},f,{prefixCls:u,className:fe(r,m,`${u}-notice-pure-panel`,k,c),eventKey:"pure",duration:null,content:p.createElement(yt,{prefixCls:u,type:a,icon:s},l)})))},Qn=Dn;function Gn(e,t){return{motionName:t??`${e}-move-up`}}function Ve(e){let t;const r=new Promise(s=>{t=e(()=>{s(!0)})}),a=()=>{t==null||t()};return a.then=(s,l)=>r.then(s,l),a.promise=r,a}var Jn=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};const Zn=8,Kn=3,Xn=e=>{let{children:t,prefixCls:r}=e;const a=ct(r),[s,l,f]=pt(r,a);return s(p.createElement(un,{classNames:{list:fe(l,f,a)}},t))},Yn=(e,t)=>{let{prefixCls:r,key:a}=t;return p.createElement(Xn,{prefixCls:r,key:a},e)},ea=p.forwardRef((e,t)=>{const{top:r,prefixCls:a,getContainer:s,maxCount:l,duration:f=Kn,rtl:d,transitionName:u,onAllRemoved:c}=e,{getPrefixCls:g,getPopupContainer:m,message:k,direction:E}=p.useContext(ge),$=a||g("message"),b=()=>({left:"50%",transform:"translateX(-50%)",top:r??Zn}),h=()=>fe({[`${$}-rtl`]:d??E==="rtl"}),O=()=>Gn($,u),v=p.createElement("span",{className:`${$}-close-x`},p.createElement(cn,{className:`${$}-close-icon`})),[C,A]=ln({prefixCls:$,style:b,className:h,motion:O,closable:!1,closeIcon:v,duration:f,getContainer:()=>(s==null?void 0:s())||(m==null?void 0:m())||document.body,maxCount:l,onAllRemoved:c,renderNotifications:Yn});return p.useImperativeHandle(t,()=>Object.assign(Object.assign({},C),{prefixCls:$,message:k})),A});let Ye=0;function vt(e){const t=p.useRef(null);return Wt(),[p.useMemo(()=>{const a=u=>{var c;(c=t.current)===null||c===void 0||c.close(u)},s=u=>{if(!t.current){const L=()=>{};return L.then=()=>{},L}const{open:c,prefixCls:g,message:m}=t.current,k=`${g}-notice`,{content:E,icon:$,type:b,key:h,className:O,style:v,onClose:C}=u,A=Jn(u,["content","icon","type","key","className","style","onClose"]);let w=h;return w==null&&(Ye+=1,w=`antd-message-${Ye}`),Ve(L=>(c(Object.assign(Object.assign({},A),{key:w,content:p.createElement(yt,{prefixCls:g,type:b,icon:$},E),placement:"top",className:fe(b&&`${k}-${b}`,O,m==null?void 0:m.className),style:Object.assign(Object.assign({},m==null?void 0:m.style),v),onClose:()=>{C==null||C(),L()}})),()=>{a(w)}))},f={open:s,destroy:u=>{var c;u!==void 0?a(u):(c=t.current)===null||c===void 0||c.destroy()}};return["info","success","warning","error","loading"].forEach(u=>{const c=(g,m,k)=>{let E;g&&typeof g=="object"&&"content"in g?E=g:E={content:g};let $,b;typeof m=="function"?b=m:($=m,b=k);const h=Object.assign(Object.assign({onClose:b,duration:$},E),{type:u});return s(h)};f[u]=c}),f},[]),p.createElement(ea,Object.assign({key:"message-holder"},e,{ref:t}))]}function ta(e){return vt(e)}let X=null,de=e=>e(),ve=[],be={};function et(){const{getContainer:e,duration:t,rtl:r,maxCount:a,top:s}=be,l=(e==null?void 0:e())||document.body;return{getContainer:()=>l,duration:t,rtl:r,maxCount:a,top:s}}const na=Q.forwardRef((e,t)=>{const{messageConfig:r,sync:a}=e,{getPrefixCls:s}=p.useContext(ge),l=be.prefixCls||s("message"),f=p.useContext(fn),[d,u]=vt(Object.assign(Object.assign(Object.assign({},r),{prefixCls:l}),f.message));return Q.useImperativeHandle(t,()=>{const c=Object.assign({},d);return Object.keys(c).forEach(g=>{c[g]=function(){return a(),d[g].apply(d,arguments)}}),{instance:c,sync:a}}),u}),aa=Q.forwardRef((e,t)=>{const[r,a]=Q.useState(et),s=()=>{a(et)};Q.useEffect(s,[]);const l=Qt(),f=l.getRootPrefixCls(),d=l.getIconPrefixCls(),u=l.getTheme(),c=Q.createElement(na,{ref:t,sync:s,messageConfig:r});return Q.createElement(Dt,{prefixCls:f,iconPrefixCls:d,theme:u},l.holderRender?l.holderRender(c):c)});function Se(){if(!X){const e=document.createDocumentFragment(),t={fragment:e};X=t,de(()=>{dn(Q.createElement(aa,{ref:r=>{const{instance:a,sync:s}=r||{};Promise.resolve().then(()=>{!t.instance&&a&&(t.instance=a,t.sync=s,Se())})}}),e)});return}X.instance&&(ve.forEach(e=>{const{type:t,skipped:r}=e;if(!r)switch(t){case"open":{de(()=>{const a=X.instance.open(Object.assign(Object.assign({},be),e.config));a==null||a.then(e.resolve),e.setCloseFn(a)});break}case"destroy":de(()=>{X==null||X.instance.destroy(e.key)});break;default:de(()=>{var a;const s=(a=X.instance)[t].apply(a,Ut(e.args));s==null||s.then(e.resolve),e.setCloseFn(s)})}}),ve=[])}function ra(e){be=Object.assign(Object.assign({},be),e),de(()=>{var t;(t=X==null?void 0:X.sync)===null||t===void 0||t.call(X)})}function sa(e){const t=Ve(r=>{let a;const s={type:"open",config:e,resolve:r,setCloseFn:l=>{a=l}};return ve.push(s),()=>{a?de(()=>{a()}):s.skipped=!0}});return Se(),t}function oa(e,t){const r=Ve(a=>{let s;const l={type:e,args:t,resolve:a,setCloseFn:f=>{s=f}};return ve.push(l),()=>{s?de(()=>{s()}):l.skipped=!0}});return Se(),r}const ia=e=>{ve.push({type:"destroy",key:e}),Se()},la=["success","info","warning","error","loading"],ca={open:sa,destroy:ia,config:ra,useMessage:ta,_InternalPanelDoNotUseOrYouWillBeFired:Qn},bt=ca;la.forEach(e=>{bt[e]=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return oa(e,r)}});const ua=bt,da=e=>{const{componentCls:t,iconCls:r,antCls:a,zIndexPopup:s,colorText:l,colorWarning:f,marginXXS:d,marginXS:u,fontSize:c,fontWeightStrong:g,colorTextHeading:m}=e;return{[t]:{zIndex:s,[`&${a}-popover`]:{fontSize:c},[`${t}-message`]:{marginBottom:u,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t}-message-icon ${r}`]:{color:f,fontSize:c,lineHeight:1,marginInlineEnd:u},[`${t}-title`]:{fontWeight:g,color:m,"&:only-child":{fontWeight:"normal"}},[`${t}-description`]:{marginTop:d,color:l}},[`${t}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:u}}}}},fa=e=>{const{zIndexPopupBase:t}=e;return{zIndexPopup:t+60}},Ct=lt("Popconfirm",e=>da(e),fa,{resetStyle:!1});var ma=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};const xt=e=>{const{prefixCls:t,okButtonProps:r,cancelButtonProps:a,title:s,description:l,cancelText:f,okText:d,okType:u="primary",icon:c=p.createElement(Pe,null),showCancel:g=!0,close:m,onConfirm:k,onCancel:E,onPopupClick:$}=e,{getPrefixCls:b}=p.useContext(ge),[h]=mn("Popconfirm",Gt.Popconfirm),O=Ke(s),v=Ke(l);return p.createElement("div",{className:`${t}-inner-content`,onClick:$},p.createElement("div",{className:`${t}-message`},c&&p.createElement("span",{className:`${t}-message-icon`},c),p.createElement("div",{className:`${t}-message-text`},O&&p.createElement("div",{className:`${t}-title`},O),v&&p.createElement("div",{className:`${t}-description`},v))),p.createElement("div",{className:`${t}-buttons`},g&&p.createElement(Oe,Object.assign({onClick:E,size:"small"},a),f||(h==null?void 0:h.cancelText)),p.createElement(hn,{buttonProps:Object.assign(Object.assign({size:"small"},gn(u)),r),actionFn:k,close:m,prefixCls:b("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},d||(h==null?void 0:h.okText))))},ha=e=>{const{prefixCls:t,placement:r,className:a,style:s}=e,l=ma(e,["prefixCls","placement","className","style"]),{getPrefixCls:f}=p.useContext(ge),d=f("popconfirm",t),[u]=Ct(d);return u(p.createElement(Pn,{placement:r,className:fe(d,a),style:s,content:p.createElement(xt,Object.assign({prefixCls:d},l))}))},ga=ha;var pa=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};const ya=p.forwardRef((e,t)=>{var r,a;const{prefixCls:s,placement:l="top",trigger:f="click",okType:d="primary",icon:u=p.createElement(Pe,null),children:c,overlayClassName:g,onOpenChange:m,onVisibleChange:k}=e,E=pa(e,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:$}=p.useContext(ge),[b,h]=pn(!1,{value:(r=e.open)!==null&&r!==void 0?r:e.visible,defaultValue:(a=e.defaultOpen)!==null&&a!==void 0?a:e.defaultVisible}),O=(B,H)=>{h(B,!0),k==null||k(B),m==null||m(B,H)},v=B=>{O(!1,B)},C=B=>{var H;return(H=e.onConfirm)===null||H===void 0?void 0:H.call(globalThis,B)},A=B=>{var H;O(!1,B),(H=e.onCancel)===null||H===void 0||H.call(globalThis,B)},w=(B,H)=>{const{disabled:J=!1}=e;J||O(B,H)},L=$("popconfirm",s),Y=fe(L,g),[G]=Ct(L);return G(p.createElement(On,Object.assign({},yn(E,["title"]),{trigger:f,placement:l,onOpenChange:w,open:b,ref:t,overlayClassName:Y,content:p.createElement(xt,Object.assign({okType:d,icon:u},e,{prefixCls:L,close:v,onConfirm:C,onCancel:A})),"data-popover-inject":!0}),c))}),wt=ya;wt._InternalPanelDoNotUseOrYouWillBeFired=ga;const va=wt;var ba={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};const Ca=ba;var xa=function(t,r){return p.createElement(dt,ot({},t,{ref:r,icon:Ca}))},wa=p.forwardRef(xa);const Ma=wa;var Na={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M834.1 469.2A347.49 347.49 0 00751.2 354l-29.1-26.7a8.09 8.09 0 00-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 01-47.5 46.1 352.6 352.6 0 00-100.3 121.5A347.75 347.75 0 00160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0075.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 00760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0027.7-136c0-48.8-10-96.2-29.9-140.9z"}}]},name:"fire",theme:"filled"};const Pa=Na;var Oa=function(t,r){return p.createElement(dt,ot({},t,{ref:r,icon:Pa}))},Sa=p.forwardRef(Oa);const tt=Sa,_a=e=>{const t=(e==null?void 0:e.resource)||"post",r=(e==null?void 0:e.dataProvider)||"wp",a=(e==null?void 0:e.pathParams)||[],s=(e==null?void 0:e.args)||void 0,l=(e==null?void 0:e.config)||void 0,f=s?[`get_${t}`,r,a,s]:[`get_${t}`,r,a];return vn(f,async()=>Sn({resource:t,dataProvider:r,pathParams:a,args:t==="cart"?{args:s,t:Date.now()}:s,config:l}),e.queryOptions||{})},Ia=e=>{const[t,r]=p.useState({value:1,defaultValue:1}),a=1,s=e??1/0;return{plusMinusInputProps:{...t,min:a,className:"w-full",addonBefore:i("span",{className:"ps-addon",onClick:()=>{const u=Number((t==null?void 0:t.value)||1);u<=a||r({...t,value:u-1})},children:"-"}),addonAfter:i("span",{className:"ps-addon",onClick:()=>{const u=Number((t==null?void 0:t.value)||1);u>=s||r({...t,value:u+1})},children:"+"}),onChange:u=>{r(u?{...t,value:u}:{...t,value:1})}},setPlusMinusInputProps:r}};function ka(e,t){var r=-1,a=e.length;for(t||(t=Array(a));++r<a;)t[r]=e[r];return t}var Ea="\\ud800-\\udfff",$a="\\u0300-\\u036f",Ta="\\ufe20-\\ufe2f",Aa="\\u20d0-\\u20ff",ja=$a+Ta+Aa,Fa="\\ufe0e\\ufe0f",Ra="\\u200d",Ba=RegExp("["+Ra+Ea+ja+Fa+"]");function La(e){return Ba.test(e)}function qa(e){return e.split("")}var Mt="\\ud800-\\udfff",Va="\\u0300-\\u036f",za="\\ufe20-\\ufe2f",Ha="\\u20d0-\\u20ff",Wa=Va+za+Ha,Ua="\\ufe0e\\ufe0f",Da="["+Mt+"]",je="["+Wa+"]",Fe="\\ud83c[\\udffb-\\udfff]",Qa="(?:"+je+"|"+Fe+")",Nt="[^"+Mt+"]",Pt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ot="[\\ud800-\\udbff][\\udc00-\\udfff]",Ga="\\u200d",St=Qa+"?",_t="["+Ua+"]?",Ja="(?:"+Ga+"(?:"+[Nt,Pt,Ot].join("|")+")"+_t+St+")*",Za=_t+St+Ja,Ka="(?:"+[Nt+je+"?",je,Pt,Ot,Da].join("|")+")",Xa=RegExp(Fe+"(?="+Fe+")|"+Ka+Za,"g");function Ya(e){return e.match(Xa)||[]}function er(e){return La(e)?Ya(e):qa(e)}var tr="[object String]";function nr(e){return typeof e=="string"||!_n(e)&&In(e)&&kn(e)==tr}function ar(e,t){return En(t,function(r){return e[r]})}function rr(e){return e==null?[]:ar(e,$n(e))}function sr(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}var or="[object Map]",ir="[object Set]",$e=Xe?Xe.iterator:void 0;function lr(e){if(!e)return[];if(Tn(e))return nr(e)?er(e):ka(e);if($e&&e[$e])return sr(e[$e]());var t=An(e),r=t==or?jn:t==ir?Fn:rr;return r(e)}const ze=ie(""),_e=ie(!1),cr=ie(0),Ie=ie(null),It=ie([]),kt=ie("published"),ur={isMutating:!1,coupons:[],shipping_rates:[],shipping_address:{address_1:"",address_2:"",city:"",state:"",postcode:"",country:"TW",first_name:"",last_name:"",company:"",phone:""},billing_address:{address_1:"",address_2:"",city:"",state:"",postcode:"",country:"TW",first_name:"",last_name:"",company:"",phone:"",email:""},items:[],items_count:0,items_weight:0,cross_sells:[],needs_payment:!0,needs_shipping:!1,has_calculated_shipping:!1,fees:[],totals:{total_items:"0",total_items_tax:"0",total_fees:"0",total_fees_tax:"0",total_discount:"0",total_discount_tax:"0",total_shipping:"0",total_shipping_tax:"0",total_price:"0",total_tax:"0",tax_lines:[],currency_code:"TWD",currency_symbol:"NT$",currency_minor_unit:0,currency_decimal_separator:".",currency_thousand_separator:",",currency_prefix:"NT$",currency_suffix:""},errors:[],payment_methods:[],payment_requirements:[],extensions:{}},Ce=ie(ur),dr=(e,t)=>{const r=we(parseInt((e==null?void 0:e.price)??"0",10),t);return T("div",{className:"flex items-center justify-between",children:[i("div",{className:"flex items-center",children:(e==null?void 0:e.name)??"未知運送方式"}),i("div",{children:`$ ${r}`})]})},fr=({cartData:e,isLoading:t})=>{var h,O,v,C,A;const r=(e==null?void 0:e.shipping_rates)??[],a=((h=e==null?void 0:e.totals)==null?void 0:h.currency_minor_unit)||0,s=((O=r==null?void 0:r[0])==null?void 0:O.package_id)??0,l=((v=r==null?void 0:r[0])==null?void 0:v.shipping_rates)??[],f=parseInt(((C=e==null?void 0:e.totals)==null?void 0:C.total_shipping)||"0",10),d=we(f,a),u=ne(ze),c=Ne(),g=l.map(w=>({value:(w==null?void 0:w.rate_id)??"",label:dr(w,a)})),m=[{value:"none",label:i(U,{children:"請選擇運送方式"})}],k=((A=l.find(w=>w.selected))==null?void 0:A.rate_id)??"",{mutate:E,isLoading:$}=ft({resource:"cart/select-shipping-rate",dataProvider:"wc-store",config:{headers:{Nonce:u}}}),b=w=>{E({package_id:s,rate_id:w},{onSuccess:()=>{c.invalidateQueries({queryKey:["get_cart"]})}})};return g.length===0?null:T("tr",{children:[T("th",{className:"text-left pl-4",colSpan:3,children:[i("span",{className:"mr-2",children:"運費"}),i(bn,{className:"min-w-[12rem]",defaultValue:m[0].value,value:g.length>0?k:m[0].value,options:g.length>0?g:m,onChange:b,loading:t,disabled:g.length===0}),g.length===0&&i(Cn,{title:'請確認您的地址"國家"欄位有可用的運送方式或者確認購物車有商品',children:i(ut,{className:"ml-2 text-orange-500"})})]}),i("th",{className:"text-right",children:i(Ae,{width:"w-[4rem]",content:`$ ${d.toLocaleString()}`,isLoading:t||$})}),i("th",{})]})};var Et={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},nt=Q.createContext&&Q.createContext(Et),ce=globalThis&&globalThis.__assign||function(){return ce=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ce.apply(this,arguments)},mr=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};function $t(e){return e&&e.map(function(t,r){return Q.createElement(t.tag,ce({key:r},t.attr),$t(t.child))})}function hr(e){return function(t){return Q.createElement(gr,ce({attr:ce({},e.attr)},t),$t(e.child))}}function gr(e){var t=function(r){var a=e.attr,s=e.size,l=e.title,f=mr(e,["attr","size","title"]),d=s||r.size||"1em",u;return r.className&&(u=r.className),e.className&&(u=(u?u+" ":"")+e.className),Q.createElement("svg",ce({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,f,{className:u,style:ce(ce({color:e.color||r.color},r.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),l&&Q.createElement("title",null,l),e.children)};return nt!==void 0?Q.createElement(nt.Consumer,null,function(r){return t(r)}):t(Et)}function pr(e){return hr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 15c-1.84 0-2-.86-2-1H8c0 .92.66 2.55 3 2.92V18h2v-1.08c2-.34 3-1.63 3-2.92 0-1.12-.52-3-4-3-2 0-2-.63-2-1s.7-1 2-1 1.39.64 1.4 1h2A3 3 0 0 0 13 7.12V6h-2v1.09C9 7.42 8 8.71 8 10c0 1.12.52 3 4 3 2 0 2 .68 2 1s-.62 1-2 1z"}},{tag:"path",attr:{d:"M5 2H2v2h2v17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V4h2V2H5zm13 18H6V4h12z"}}]})(e)}const yr=700,vr=({item:e})=>{const t=(e==null?void 0:e.quantity)||1,[r,a]=re(Ce),s=Cr(e.id),l=Ne(),[f,d]=qe.useNotification(),u=ne(ze),c=(e==null?void 0:e.key)||"",{mutate:g}=ft({resource:"cart/update-item",dataProvider:"wc-store",mutationOptions:{onMutate:b=>{a(O=>({...O,isMutating:!0,items:O.items.map(v=>v.key===b.key?{...v,isMutating:!0}:v)}));const h=r.items.find(O=>O.key===b.key);if(h)return{...h,quantity:h.quantity_raw}},onSuccess:()=>{l.invalidateQueries({queryKey:["get_cart"]})},onError:(b,h,O)=>{var v,C;console.log("Error",b),f.error({message:((C=(v=b==null?void 0:b.response)==null?void 0:v.data)==null?void 0:C.message)||"修改購物車失敗"}),a(A=>({...A,isMutating:!1,items:A.items.map(w=>w.key===O.key?O:w)}))}},config:{headers:{Nonce:u}}}),m=async()=>{a($("DECREMENT"))},k=async()=>{a($("INCREMENT"))},E=async b=>{b&&a($(b))},$=b=>h=>h.items.find(v=>v.key===c)?{...h,items:h.items.map(v=>{if(v.key===c){const C=br(b,v,s);return{...v,quantity:C}}return v})}:h;return p.useEffect(()=>{if(t!==(e==null?void 0:e.quantity_raw)){const b=setTimeout(()=>{g({key:c,quantity:t})},yr);return()=>clearTimeout(b)}},[t]),T(U,{children:[d,i(mt,{className:"w-full",min:1,max:s,addonBefore:i("span",{className:"ps-addon",onClick:m,children:"-"}),addonAfter:i("span",{className:"ps-addon",onClick:k,children:"+"}),value:t,onChange:E})]})};function br(e,t,r){const a=Number(t.quantity);switch(e){case"DECREMENT":return a<=1?1:a-1;case"INCREMENT":return a>=r?r:a+1;case null:return 1;default:return e>=r?r:e}}function Cr(e){const t=window.appData.products_info.products.find(s=>s.id===e);if(t){const s=t==null?void 0:t.stock;return((t==null?void 0:t.backorders)??"no")!=="no"?1/0:(s==null?void 0:s.stockQuantity)??1/0}const a=window.appData.products_info.products.flatMap(s=>s==null?void 0:s.variations).filter(s=>!!s).find(s=>(s==null?void 0:s.variation_id)===e);if(a){const s=a==null?void 0:a.stock;return(a==null?void 0:a.backorders_allowed)??!1?1/0:(s==null?void 0:s.stockQuantity)??1/0}return 1/0}const xr=()=>{var w,L,Y,G,B,H,J,pe,q,se;const e=ye(ze),[t,r]=re(Ce),a=((L=(w=window==null?void 0:window.appData)==null?void 0:w.products_info)==null?void 0:L.meta)??[],{mutate:s,isLoading:l}=gt({mutationOptions:{onMutate:_=>(r(W=>({...W,items:W.items.filter(le=>le.key!==_.cart_item_key),isMutating:!0})),t.items.find(W=>W.key===_.cart_item_key))}}),[f,d]=qe.useNotification(),u=Ne(),c=_a({resource:"cart",dataProvider:"wc-store",queryOptions:{cacheTime:0,staleTime:0}}),g=((G=(Y=c==null?void 0:c.data)==null?void 0:Y.headers)==null?void 0:G["x-wc-store-api-nonce"])||((H=(B=c==null?void 0:c.data)==null?void 0:B.headers)==null?void 0:H.nonce)||"",m=((J=c==null?void 0:c.data)==null?void 0:J.data)||{},k=(c==null?void 0:c.isFetching)||!1,E=((pe=m==null?void 0:m.totals)==null?void 0:pe.currency_minor_unit)||0,$=Number(((q=m==null?void 0:m.totals)==null?void 0:q.total_items)||"0"),b=we($,E),h=Number(((se=m==null?void 0:m.totals)==null?void 0:se.total_price)||"0"),O=we(h,E),v=(t==null?void 0:t.items)??[];p.useEffect(()=>{e(g)},[g]),p.useEffect(()=>{if(!(c!=null&&c.isFetching)){const K=((m==null?void 0:m.items)||[]).map(W=>({key:W.key,id:W.id,quantity:W.quantity,quantity_raw:W.quantity,name:W.name,short_description:W.short_description,description:W.description,images:W.images,variation:W.variation,isMutating:!1}));r({...m,items:K,isMutating:!1})}},[c==null?void 0:c.isFetching]);const C=_=>()=>{s({action:"handle_remove_cart",cart_item_key:_},{onSuccess:()=>{f.success({message:"移除購物車成功"}),u.invalidateQueries({queryKey:["get_cart"]})},onError:(K,W,le)=>{var me,o;console.log("Error",K),f.error({message:((o=(me=K==null?void 0:K.response)==null?void 0:me.data)==null?void 0:o.message)||"移除購物車失敗"}),r(n=>({...n,isMutating:!1,items:n.items.map(y=>y.key===le.key?le:y)}))}})},A=T("table",{id:"ps-cart-table",className:"ps-cart-table",children:[i("thead",{children:T("tr",{children:[i("th",{"data-key":"product",children:"商品"}),i("th",{"data-key":"qty",children:"數量"}),i("th",{"data-key":"unit_price",children:"單價"}),i("th",{"data-key":"total",children:"小計"}),i("th",{"data-key":"action"})]})}),T("tbody",{children:[v.length===0&&i("tr",{children:i("td",{colSpan:5,children:i(Me,{image:Me.PRESENTED_IMAGE_SIMPLE,description:"沒有資料"})})}),v.length!==0&&v.map(_=>{var I,x;const K=(_==null?void 0:_.variation)??[],W=K.map(N=>`${N==null?void 0:N.attribute}: ${N==null?void 0:N.value}`).join(" | "),le=K.length>0,me=((x=(I=_==null?void 0:_.images)==null?void 0:I[0])==null?void 0:x.src)||he,o=(_==null?void 0:_.id)??"",n=wr({productId:o,isVariable:le,shop_meta:a}),y=(n==null?void 0:n.regularPrice)??0,M=(n==null?void 0:n.salesPrice)??0,P=M||y,S=(_==null?void 0:_.quantity)??1;return T("tr",{className:`${_.isMutating?"animate-pulse":""}`,children:[i("td",{children:T("div",{className:"flex",children:[i("img",{className:"w-16 h-16 rounded-md aspect-square object-cover mr-2",src:me}),T("div",{className:"text-left",children:[i("h6",{className:"font-normal text-lg mb-2 mt-0",children:Re(_==null?void 0:_.name)}),i("div",{className:"my-0 text-xs",children:W})]})]})}),i("td",{children:i(vr,{item:_})}),i("td",{children:`$ ${P.toLocaleString()}`}),i("td",{children:`$ ${(Number(P)*Number(S)).toLocaleString()}`}),i("td",{children:i(va,{title:"確定要從購物車移除嗎?",onConfirm:C(_.key),okText:"確認",cancelText:"再想想",children:i(Ma,{className:"text-red-500 cursor-pointer"})})})]},_.key)})]}),T("tfoot",{children:[T("tr",{children:[i("th",{className:"text-left pl-4",children:"小計"}),i("th",{}),i("th",{}),i("th",{children:i(Ae,{width:"w-[4rem]",content:`$ ${b.toLocaleString()}`,isLoading:l||c.isFetching})}),i("th",{})]}),i(fr,{cartData:t,isLoading:k}),T("tr",{children:[i("th",{className:"text-left pl-4",children:"合計"}),i("th",{}),i("th",{}),i("th",{children:i(Ae,{width:"w-[4rem]",content:`$ ${O.toLocaleString()}`,isLoading:l||c.isFetching})}),i("th",{})]})]})]});return v.length===0?null:T("div",{className:"w-full mt-20",children:[d,A,i("div",{className:"text-right mb-8",children:i("a",{href:Jt,children:i(Oe,{icon:i(pr,{className:"relative top-[2px]"}),size:"large",className:"px-12",type:"primary",disabled:v.length===0||t.isMutating,children:"前往結帳"})})})]})};function wr({productId:e,isVariable:t,shop_meta:r}){return t?r.filter(l=>{var f;return((f=(l==null?void 0:l.variations)||[])==null?void 0:f.length)>0}).map(l=>l.variations).flat().find(l=>(l==null?void 0:l.variationId)===e):r.find(l=>l.productId===e)}const Mr=({products:e})=>e.length===0?i(Me,{image:Me.PRESENTED_IMAGE_SIMPLE,description:"沒有資料"}):i("div",{className:`${Zt}-products`,children:i(xr,{})}),Nr=({images:e,selectedImage:t})=>{if(e.length===0)return i("img",{className:"aspect-square w-full object-cover",src:he});const r=e.some(d=>d===t),[a,s]=p.useState(e[0]),l=d=>()=>{s(d||he)},f=e.find(d=>d===a)||e[0]||he;return p.useEffect(()=>{s(t&&r?t:e[0])},[t]),T(U,{children:[i("img",{className:"aspect-square w-full object-cover",src:f}),e.length>1&&i("div",{className:"mt-2 w-full grid grid-cols-4 gap-2",children:e.map((d,u)=>i("img",{className:`aspect-square cursor-pointer object-cover w-full ${d===a&&"border-2 border-blue-500 border-solid"}`,onClick:l(d),src:d||he,style:{width:"-webkit-fill-available"}},`${d}-${u}`))})]})};const Pr=({stockQty:e,...t})=>{const a=(s=>s==null?t:s>=0?{...t,max:s}:t)(e);return i(mt,{...a})},Te={manageStock:!1,stockQuantity:null,stockStatus:"instock"},at=()=>T(U,{children:[i(Le,{className:"mr-2 text-red-500"}),"此商品已售完"]}),xe=({qty:e,text:t="此商品還有庫存",qtyInCart:r})=>T(U,{children:[i(Be,{className:"mr-2 text-green-500"}),t,e!==void 0?` ${e} 件`:"",i(Tt,{qty:r})]}),Or=({qtyInCart:e})=>T(U,{children:[i(Pe,{className:"mr-2 text-orange-500"}),"此商品為延期交貨商品",i(Tt,{qty:e})]}),Tt=({qty:e,text:t="，已加入購物車"})=>e?T(U,{children:[t,e!==void 0?` ${e} 件`:""]}):i(U,{}),Sr=({product:e,selectedVariationId:t})=>{var f;const r=ne(Ce);if(!Kt)return i(U,{});const s=((f=((r==null?void 0:r.items)??[]).find(d=>d.id===(e==null?void 0:e.id)))==null?void 0:f.quantity)??0,l=_r(e,t,s);return i("p",{className:"m-0 text-gray-500 text-xs",children:l})};function _r(e,t,r){var d;let a=Te;if(!t)a=(e==null?void 0:e.stock)??Te;else{const u=(d=e==null?void 0:e.variations)==null?void 0:d.find(c=>c.variation_id===t);a=(u==null?void 0:u.stock)??Te}const{manageStock:s,stockQuantity:l,stockStatus:f}=a;switch(f){case"instock":return s?s&&l?l<=10?i(xe,{qty:l,text:"此商品只剩最後",qtyInCart:r}):i(xe,{qty:l,text:"此商品剩餘",qtyInCart:r}):i(at,{}):i(xe,{qtyInCart:r});case"outofstock":return i(at,{});case"onbackorder":return i(Or,{qtyInCart:r});default:return i(xe,{qtyInCart:r})}}const Ir=({product:e,selectedVariationId:t})=>{var s;if(!Xt)return i(U,{});const{type:r}=e,a=(e==null?void 0:e.total_sales)||0;if(r==="simple"){const l=(e==null?void 0:e.extraBuyerCount)||0;return T("p",{className:"m-0 text-gray-500 text-xs",children:[i(tt,{className:"mr-2 text-red-400"}),"已有 ",a+l," 人購買"]})}if(r==="variable"){if(t){const l=(s=e==null?void 0:e.variations)==null?void 0:s.find(d=>d.variation_id===t),f=(l==null?void 0:l.extraBuyerCount)||0;return T("p",{className:"m-0 text-gray-500 text-xs",children:[i(tt,{className:"mr-2 text-blue-500"}),"已有 ",a+f," 人購買"]})}return i(U,{})}return i(U,{})};var He={};(function e(t,r,a,s){var l=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),f=typeof Path2D=="function"&&typeof DOMMatrix=="function",d=function(){if(!t.OffscreenCanvas)return!1;var o=new OffscreenCanvas(1,1),n=o.getContext("2d");n.fillRect(0,0,1,1);var y=o.transferToImageBitmap();try{n.createPattern(y,"no-repeat")}catch{return!1}return!0}();function u(){}function c(o){var n=r.exports.Promise,y=n!==void 0?n:t.Promise;return typeof y=="function"?new y(o):(o(u,u),null)}var g=function(o,n){return{transform:function(y){if(o)return y;if(n.has(y))return n.get(y);var M=new OffscreenCanvas(y.width,y.height),P=M.getContext("2d");return P.drawImage(y,0,0),n.set(y,M),M},clear:function(){n.clear()}}}(d,new Map),m=function(){var o=Math.floor(16.666666666666668),n,y,M={},P=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(n=function(S){var I=Math.random();return M[I]=requestAnimationFrame(function x(N){P===N||P+o-1<N?(P=N,delete M[I],S()):M[I]=requestAnimationFrame(x)}),I},y=function(S){M[S]&&cancelAnimationFrame(M[S])}):(n=function(S){return setTimeout(S,o)},y=function(S){return clearTimeout(S)}),{frame:n,cancel:y}}(),k=function(){var o,n,y={};function M(P){function S(I,x){P.postMessage({options:I||{},callback:x})}P.init=function(x){var N=x.transferControlToOffscreen();P.postMessage({canvas:N},[N])},P.fire=function(x,N,F){if(n)return S(x,null),n;var V=Math.random().toString(36).slice(2);return n=c(function(R){function z(D){D.data.callback===V&&(delete y[V],P.removeEventListener("message",z),n=null,g.clear(),F(),R())}P.addEventListener("message",z),S(x,V),y[V]=z.bind(null,{data:{callback:V}})}),n},P.reset=function(){P.postMessage({reset:!0});for(var x in y)y[x](),delete y[x]}}return function(){if(o)return o;if(!a&&l){var P=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{o=new Worker(URL.createObjectURL(new Blob([P])))}catch(S){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",S),null}M(o)}return o}}(),E={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function $(o,n){return n?n(o):o}function b(o){return o!=null}function h(o,n,y){return $(o&&b(o[n])?o[n]:E[n],y)}function O(o){return o<0?0:Math.floor(o)}function v(o,n){return Math.floor(Math.random()*(n-o))+o}function C(o){return parseInt(o,16)}function A(o){return o.map(w)}function w(o){var n=String(o).replace(/[^0-9a-f]/gi,"");return n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),{r:C(n.substring(0,2)),g:C(n.substring(2,4)),b:C(n.substring(4,6))}}function L(o){var n=h(o,"origin",Object);return n.x=h(n,"x",Number),n.y=h(n,"y",Number),n}function Y(o){o.width=document.documentElement.clientWidth,o.height=document.documentElement.clientHeight}function G(o){var n=o.getBoundingClientRect();o.width=n.width,o.height=n.height}function B(o){var n=document.createElement("canvas");return n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.pointerEvents="none",n.style.zIndex=o,n}function H(o,n,y,M,P,S,I,x,N){o.save(),o.translate(n,y),o.rotate(S),o.scale(M,P),o.arc(0,0,1,I,x,N),o.restore()}function J(o){var n=o.angle*(Math.PI/180),y=o.spread*(Math.PI/180);return{x:o.x,y:o.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:o.startVelocity*.5+Math.random()*o.startVelocity,angle2D:-n+(.5*y-Math.random()*y),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:o.color,shape:o.shape,tick:0,totalTicks:o.ticks,decay:o.decay,drift:o.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:o.gravity*3,ovalScalar:.6,scalar:o.scalar,flat:o.flat}}function pe(o,n){n.x+=Math.cos(n.angle2D)*n.velocity+n.drift,n.y+=Math.sin(n.angle2D)*n.velocity+n.gravity,n.velocity*=n.decay,n.flat?(n.wobble=0,n.wobbleX=n.x+10*n.scalar,n.wobbleY=n.y+10*n.scalar,n.tiltSin=0,n.tiltCos=0,n.random=1):(n.wobble+=n.wobbleSpeed,n.wobbleX=n.x+10*n.scalar*Math.cos(n.wobble),n.wobbleY=n.y+10*n.scalar*Math.sin(n.wobble),n.tiltAngle+=.1,n.tiltSin=Math.sin(n.tiltAngle),n.tiltCos=Math.cos(n.tiltAngle),n.random=Math.random()+2);var y=n.tick++/n.totalTicks,M=n.x+n.random*n.tiltCos,P=n.y+n.random*n.tiltSin,S=n.wobbleX+n.random*n.tiltCos,I=n.wobbleY+n.random*n.tiltSin;if(o.fillStyle="rgba("+n.color.r+", "+n.color.g+", "+n.color.b+", "+(1-y)+")",o.beginPath(),f&&n.shape.type==="path"&&typeof n.shape.path=="string"&&Array.isArray(n.shape.matrix))o.fill(W(n.shape.path,n.shape.matrix,n.x,n.y,Math.abs(S-M)*.1,Math.abs(I-P)*.1,Math.PI/10*n.wobble));else if(n.shape.type==="bitmap"){var x=Math.PI/10*n.wobble,N=Math.abs(S-M)*.1,F=Math.abs(I-P)*.1,V=n.shape.bitmap.width*n.scalar,R=n.shape.bitmap.height*n.scalar,z=new DOMMatrix([Math.cos(x)*N,Math.sin(x)*N,-Math.sin(x)*F,Math.cos(x)*F,n.x,n.y]);z.multiplySelf(new DOMMatrix(n.shape.matrix));var D=o.createPattern(g.transform(n.shape.bitmap),"no-repeat");D.setTransform(z),o.globalAlpha=1-y,o.fillStyle=D,o.fillRect(n.x-V/2,n.y-R/2,V,R),o.globalAlpha=1}else if(n.shape==="circle")o.ellipse?o.ellipse(n.x,n.y,Math.abs(S-M)*n.ovalScalar,Math.abs(I-P)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI):H(o,n.x,n.y,Math.abs(S-M)*n.ovalScalar,Math.abs(I-P)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI);else if(n.shape==="star")for(var j=Math.PI/2*3,Z=4*n.scalar,ee=8*n.scalar,te=n.x,oe=n.y,ue=5,ae=Math.PI/ue;ue--;)te=n.x+Math.cos(j)*ee,oe=n.y+Math.sin(j)*ee,o.lineTo(te,oe),j+=ae,te=n.x+Math.cos(j)*Z,oe=n.y+Math.sin(j)*Z,o.lineTo(te,oe),j+=ae;else o.moveTo(Math.floor(n.x),Math.floor(n.y)),o.lineTo(Math.floor(n.wobbleX),Math.floor(P)),o.lineTo(Math.floor(S),Math.floor(I)),o.lineTo(Math.floor(M),Math.floor(n.wobbleY));return o.closePath(),o.fill(),n.tick<n.totalTicks}function q(o,n,y,M,P){var S=n.slice(),I=o.getContext("2d"),x,N,F=c(function(V){function R(){x=N=null,I.clearRect(0,0,M.width,M.height),g.clear(),P(),V()}function z(){a&&!(M.width===s.width&&M.height===s.height)&&(M.width=o.width=s.width,M.height=o.height=s.height),!M.width&&!M.height&&(y(o),M.width=o.width,M.height=o.height),I.clearRect(0,0,M.width,M.height),S=S.filter(function(D){return pe(I,D)}),S.length?x=m.frame(z):R()}x=m.frame(z),N=R});return{addFettis:function(V){return S=S.concat(V),F},canvas:o,promise:F,reset:function(){x&&m.cancel(x),N&&N()}}}function se(o,n){var y=!o,M=!!h(n||{},"resize"),P=!1,S=h(n,"disableForReducedMotion",Boolean),I=l&&!!h(n||{},"useWorker"),x=I?k():null,N=y?Y:G,F=o&&x?!!o.__confetti_initialized:!1,V=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,R;function z(j,Z,ee){for(var te=h(j,"particleCount",O),oe=h(j,"angle",Number),ue=h(j,"spread",Number),ae=h(j,"startVelocity",Number),jt=h(j,"decay",Number),Ft=h(j,"gravity",Number),Rt=h(j,"drift",Number),Ue=h(j,"colors",A),Bt=h(j,"ticks",Number),De=h(j,"shapes"),Lt=h(j,"scalar"),qt=!!h(j,"flat"),Qe=L(j),Ge=te,ke=[],Vt=o.width*Qe.x,zt=o.height*Qe.y;Ge--;)ke.push(J({x:Vt,y:zt,angle:oe,spread:ue,startVelocity:ae,color:Ue[Ge%Ue.length],shape:De[v(0,De.length)],ticks:Bt,decay:jt,gravity:Ft,drift:Rt,scalar:Lt,flat:qt}));return R?R.addFettis(ke):(R=q(o,ke,N,Z,ee),R.promise)}function D(j){var Z=S||h(j,"disableForReducedMotion",Boolean),ee=h(j,"zIndex",Number);if(Z&&V)return c(function(ae){ae()});y&&R?o=R.canvas:y&&!o&&(o=B(ee),document.body.appendChild(o)),M&&!F&&N(o);var te={width:o.width,height:o.height};x&&!F&&x.init(o),F=!0,x&&(o.__confetti_initialized=!0);function oe(){if(x){var ae={getBoundingClientRect:function(){if(!y)return o.getBoundingClientRect()}};N(ae),x.postMessage({resize:{width:ae.width,height:ae.height}});return}te.width=te.height=null}function ue(){R=null,M&&(P=!1,t.removeEventListener("resize",oe)),y&&o&&(document.body.contains(o)&&document.body.removeChild(o),o=null,F=!1)}return M&&!P&&(P=!0,t.addEventListener("resize",oe,!1)),x?x.fire(j,te,ue):z(j,te,ue)}return D.reset=function(){x&&x.reset(),R&&R.reset()},D}var _;function K(){return _||(_=se(null,{useWorker:!0,resize:!0})),_}function W(o,n,y,M,P,S,I){var x=new Path2D(o),N=new Path2D;N.addPath(x,new DOMMatrix(n));var F=new Path2D;return F.addPath(N,new DOMMatrix([Math.cos(I)*P,Math.sin(I)*P,-Math.sin(I)*S,Math.cos(I)*S,y,M])),F}function le(o){if(!f)throw new Error("path confetti are not supported in this browser");var n,y;typeof o=="string"?n=o:(n=o.path,y=o.matrix);var M=new Path2D(n),P=document.createElement("canvas"),S=P.getContext("2d");if(!y){for(var I=1e3,x=I,N=I,F=0,V=0,R,z,D=0;D<I;D+=2)for(var j=0;j<I;j+=2)S.isPointInPath(M,D,j,"nonzero")&&(x=Math.min(x,D),N=Math.min(N,j),F=Math.max(F,D),V=Math.max(V,j));R=F-x,z=V-N;var Z=10,ee=Math.min(Z/R,Z/z);y=[ee,0,0,ee,-Math.round(R/2+x)*ee,-Math.round(z/2+N)*ee]}return{type:"path",path:n,matrix:y}}function me(o){var n,y=1,M="#000000",P='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof o=="string"?n=o:(n=o.text,y="scalar"in o?o.scalar:y,P="fontFamily"in o?o.fontFamily:P,M="color"in o?o.color:M);var S=10*y,I=""+S+"px "+P,x=new OffscreenCanvas(S,S),N=x.getContext("2d");N.font=I;var F=N.measureText(n),V=Math.ceil(F.actualBoundingBoxRight+F.actualBoundingBoxLeft),R=Math.ceil(F.actualBoundingBoxAscent+F.actualBoundingBoxDescent),z=2,D=F.actualBoundingBoxLeft+z,j=F.actualBoundingBoxAscent+z;V+=z+z,R+=z+z,x=new OffscreenCanvas(V,R),N=x.getContext("2d"),N.font=I,N.fillStyle=M,N.fillText(n,D,j);var Z=1/y;return{type:"bitmap",bitmap:x.transferToImageBitmap(),matrix:[Z,0,0,Z,-V*Z/2,-R*Z/2]}}r.exports=function(){return K().apply(this,arguments)},r.exports.reset=function(){K().reset()},r.exports.create=se,r.exports.shapeFromPath=le,r.exports.shapeFromText=me})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),He,!1);const kr=He.exports;He.exports.create;const Er=({product:e,quantity:t})=>{var v;const r=Ne(),a=ye(_e),[s,l]=re(Ce),f=e==null?void 0:e.id,{mutate:d}=gt({mutationOptions:{onMutate:C=>{if(u.success({key:"cart_add",message:T("div",{children:[i("p",{className:"m-0",children:"加入購物車成功"}),i("p",{className:"m-0 cursor-pointer text-primary",onClick:()=>{const q=document.getElementById("ps-cart-table");q&&q.scrollIntoView({behavior:"smooth"})},children:"前往購物車"})]})}),Yt){const q={particleCount:150,scalar:.75,ticks:60,startVelocity:70,spread:360,origin:{x:rt(.1,.9),y:rt(-.2,.8)}};for(let se=0;se<3;se++)kr(q)}const A=C.variation_id,{id:w,name:L,short_description:Y,description:G,images:B}=e,H=JSON.parse(C.variation);a(!1);const J={key:Rn(),id:A?Number(A):w,quantity:t,quantity_raw:t,name:L,short_description:Y,description:G,images:B.map(q=>({src:q??he})),variation:H?H.map(q=>({attribute:q.name,value:q.value})):[],isMutating:!0};return l(q=>q.items.find(_=>_.id===J.id&&JSON.stringify(_.variation)===JSON.stringify(J.variation))?{...q,isMutating:!0,items:q.items.map(_=>_.id===J.id&&JSON.stringify(_.variation)===JSON.stringify(J.variation)?{..._,quantity:Number(_.quantity)+Number(J.quantity),quantity_raw:Number(_.quantity),isMutating:!0}:_)}:{...q,isMutating:!0,items:[...q.items,J]}),s.items.find(q=>q.id===J.id)}}}),[u,c]=qe.useNotification(),g=ne(Ie),m=ne(It),k=ne(kt),E=()=>{d({action:"handle_add_cart",post_id:it,id:f,quantity:t,variation:JSON.stringify(m??[]),variation_id:g??""},{onSuccess:()=>{r.invalidateQueries({queryKey:["get_cart"]}),window.jQuery("body").trigger("wc_fragment_refresh")},onError:(C,A,w)=>{var L,Y;console.log("Error",C),u.error({key:"cart_add",message:T("div",{children:[i("p",{className:"m-0",children:"OOPS! 出了點問題"}),i("p",{className:"m-0",children:((Y=(L=C==null?void 0:C.response)==null?void 0:L.data)==null?void 0:Y.message)||"加入購物車失敗"})]})}),l(w?G=>({...G,isMutating:!1,items:G.items.map(B=>B.key===w.key?w:B)}):G=>({...G,isMutating:!1,items:G.items.filter(B=>B.id!==A.id)}))}})},$=ht(e,g),h=((v=((s==null?void 0:s.items)??[]).find(C=>C.id===(e==null?void 0:e.id)))==null?void 0:v.quantity)??0,O=Number($)-Number(h);return T(U,{children:[c,i(Oe,{className:"w-full mt-4",type:"primary",onClick:E,disabled:!O||!$r(e,g,k),children:"加入購物車"})]})};function rt(e,t){return Math.random()*(t-e)+e}function $r(e,t,r,a){var s,l,f;if(r!=="published")return!1;if(e.type==="variable"){const d=(s=e==null?void 0:e.variations)==null?void 0:s.find(c=>c.variation_id===t),u=(l=d==null?void 0:d.stock)==null?void 0:l.stockStatus;return!!t&&u!=="outofstock"}else if(e.type==="simple")return((f=e==null?void 0:e.stock)==null?void 0:f.stockStatus)!=="outofstock";return!0}const We=ie(!1),At=ie(!1),Tr=({content:e})=>{const[t,r]=re(We),[a,s]=re(At),l=Re(e),f=p.useRef(null);return p.useEffect(()=>{const u=setTimeout(()=>{var c;f&&((((c=f.current)==null?void 0:c.clientHeight)||0)>299?s(!0):s(!1))},0);return()=>{clearTimeout(u)}},[f,e]),i(U,{children:T("div",{ref:f,className:"h-full overflow-hidden relative",children:[i("div",{className:`${t?"h-full":"max-h-[300px]"}`,children:l}),!t&&a&&i("div",{onClick:()=>{r(!0)},className:"absolute bottom-0 text-center w-full pb-4 pt-12 bg-gradient-to-t from-white to-white/0 cursor-pointer"})]})})},Ar=({product:e})=>{const[t,r]=re(Ie),[a,s]=re(It),l=ne(_e),f=(e==null?void 0:e.variations)??[],d=(e==null?void 0:e.variation_attributes)??{},u=(e==null?void 0:e.attributes)??[],c=(g,m)=>()=>{const k=a.filter(v=>v.name!==g),E={name:g,value:m??""},$=[...k,E],b=Object.keys(d).map(v=>v),h=Bn($,v=>{const C=b.indexOf(v.name);return C!==-1?C:1/0});s(h);const O=f.find(v=>{const C=v==null?void 0:v.attributes;return Object.keys(C).every(A=>{const w=h.find(L=>`attribute_${decodeURIComponent(L.name.toLowerCase())}`===decodeURIComponent(A.toLowerCase()));return(w==null?void 0:w.value)===C[A]})});r(O?O.variation_id:null)};return p.useEffect(()=>{l&&(s([]),r(null))},[l]),T(U,{children:[Object.keys(d).map(g=>{const m=u==null?void 0:u.find(b=>b.slug===g),k=(m==null?void 0:m.options)||[],E=lr(d[g]),$=a.find(b=>b.name===g)??{name:"",value:""};return T("div",{className:"mb-4",children:[i("p",{className:"mb-0",children:m==null?void 0:m.name}),i("div",{className:"flex flex-wrap",children:E.map(b=>{var h;return i(Oe,{type:`${$.value===b?"primary":"default"}`,onClick:c(g,b),size:"small",className:"mr-1 mb-1",children:i("span",{className:"text-xs",children:(h=k==null?void 0:k.find(O=>(O==null?void 0:O.value)===decodeURI(b)))==null?void 0:h.name})},b)})})]},g)}),!t&&T("p",{className:"m-0 text-gray-500 text-xs",children:[i(Le,{className:"mr-2 text-red-500"}),"未選擇商品屬性"]}),t&&T("p",{className:"m-0 text-gray-500 text-xs",children:[i(Be,{className:"mr-2 text-green-500"}),"已選擇商品屬性"]})]})},st=({salePrice:e,regularPrice:t})=>e?T("div",{children:[i("p",{className:"mb-0",children:i("del",{children:Ee({price:t})})}),i("p",{className:"mb-0 text-red-500",children:Ee({price:e})})]}):i("div",{children:i("p",{className:"mb-0",children:Ee({price:t})})}),jr=e=>{var C;const[t,r]=re(_e),a=ne(Ie),s={centered:!0,footer:null,className:"lg:w-1/2 lg:max-w-[960px]",open:t,onCancel:()=>r(!1),zIndex:1e6},l=Re((e==null?void 0:e.name)??"未知商品"),f=en(`${(e==null?void 0:e.shortDescription)||""}${(e==null?void 0:e.description)||""}`),d=(e==null?void 0:e.images)??[],u=ht(e,a),c=ne(Ce),m=((C=((c==null?void 0:c.items)??[]).find(A=>A.id===(e==null?void 0:e.id)))==null?void 0:C.quantity)??0,k=Number(u)-Number(m),{plusMinusInputProps:E,setPlusMinusInputProps:$}=Ia(k),b=ye(We);p.useEffect(()=>{t&&($({...E,value:1}),b(!1))},[t]);const h=(e==null?void 0:e.type)??"simple",v=(()=>{switch(h){case"simple":return i(st,{salePrice:e==null?void 0:e.salesPrice,regularPrice:e==null?void 0:e.regularPrice});case"variable":const w=((e==null?void 0:e.variations)??[]).find(L=>L.variation_id===a);return i(st,{salePrice:w==null?void 0:w.salesPrice,regularPrice:w==null?void 0:w.regularPrice});default:return"找不到價格"}})();return{modalProps:s,images:d,name:l,price:v,description:f,plusMinusInputProps:E,qty:Number((E==null?void 0:E.value)||1),selectedVariationId:a}},Fr=({product:e})=>{const t=ne(Ie),{modalProps:r,images:a,name:s,price:l,description:f,plusMinusInputProps:d,qty:u}=jr(e),[c,g]=re(We),m=ne(At),k=()=>{g(!c)};return T(xn,{...r,children:[T(wn,{gutter:24,className:"max-h-[75vh] overflow-y-auto overflow-x-hidden",children:[i(Ze,{span:24,lg:{span:10},className:"mb-4 relative",children:i("div",{className:"sticky top-0",children:i(Nr,{images:a})})}),i(Ze,{span:24,lg:{span:14},children:T("div",{className:"flex flex-col",children:[i("div",{children:i("div",{className:"text-xl mb-4",children:s})}),i("div",{className:"my-4",children:i(Tr,{content:f})}),T("div",{children:[(e==null?void 0:e.type)==="variable"&&!!e&&i(Ar,{product:e}),i(Sr,{product:e,selectedVariationId:t}),i(Ir,{product:e,selectedVariationId:t})]}),i("div",{className:"mt-4",children:l}),T("div",{children:[i("p",{className:"mb-0 mt-4",children:"數量"}),i(Pr,{...d}),i(Er,{product:e,quantity:u})]})]})})]}),m&&i("div",{className:"absolute bottom-24 right-0 md:-right-8 bg-white w-8 flex items-center py-3 cursor-pointer shadow md:shadow-none opacity-50 md:opacity-100 rounded-l-lg md:rounded-l-none md:rounded-r-lg",style:{writingMode:"vertical-rl"},onClick:k,children:c?T(U,{children:[i(Ln,{className:"mb-2"}),"收合全部內容"]}):T(U,{children:[i(qn,{className:"mb-2"}),"展開全部內容"]})})]})},Rr=({startTime:e,endTime:t})=>{const r=Nn().valueOf();if(!e&&!t)return"published";if(!e&&t)return r<t?"published":"closed";if(e&&!t)return r>e?"published":"coming";if(e&&t){if(r<e)return"coming";if(r>t)return"closed";if(r>e&&r<t)return"published"}return"published"},Br=()=>{var O,v;const e=Mn({post_id:it,meta_key:`${tn}_settings`,formatter:C=>JSON.parse(C||"{}")}),{isLoading:t,isSuccess:r,isError:a,error:s}=e,l=(e==null?void 0:e.meta)??Vn,f=l==null?void 0:l.startTime,d=l==null?void 0:l.endTime,u=Rr({startTime:f,endTime:d}),c=ye(kt),g=((v=(O=window==null?void 0:window.appData)==null?void 0:O.products_info)==null?void 0:v.products)??[],m=ye(_e),[k,E]=re(cr),$=g.find(C=>C.id===k),b=document.querySelectorAll("div[data-ps-product-id]")??[],h=C=>A=>{A.preventDefault(),A.stopPropagation(),m(!0),E(C)};return p.useEffect(()=>{var C;t||(r?b.forEach(A=>{A.classList.remove("ps-not-ready");const w=parseInt(A.getAttribute("data-ps-product-id")??"0",10);if(w)return A.addEventListener("click",h(w)),()=>{A.removeEventListener("click",h(w))}}):a&&(((C=s==null?void 0:s.response)==null?void 0:C.status)??500)!==403&&ua.open({key:"jsLoaded",type:"error",content:" 商品載入失敗，請重新刷新頁面再試一次",duration:0}))},[t]),p.useEffect(()=>{c(u)},[u]),T(U,{children:[i(Mr,{products:g}),$&&i(Fr,{product:$})]})};function Hr(){return i(nn,{hashPriority:"high",children:i(Br,{})})}export{Hr as default};
//# sourceMappingURL=App3-6874dc25.js.map
